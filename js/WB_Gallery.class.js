function WB_Gallery(t){this.__construct(t)}WB_Gallery.prototype.elem=null,WB_Gallery.prototype.id=null,WB_Gallery.prototype.type="thumbs",WB_Gallery.prototype.slideshowInterval=10,WB_Gallery.prototype.slideshowSpeed=400,WB_Gallery.prototype.images=[],WB_Gallery.prototype.imageIndex=0,WB_Gallery.prototype.slideshowTimer=null,WB_Gallery.prototype.displayedImage=null,WB_Gallery.prototype.loadingImage=null,WB_Gallery.prototype.listImgCont=null,WB_Gallery.prototype.thumbImgCont=null,WB_Gallery.prototype.fullThumbWidth=0,WB_Gallery.prototype.fullThumbHeight=0,WB_Gallery.prototype.thumbWidth=64,WB_Gallery.prototype.thumbHeight=64,WB_Gallery.prototype.columnWidth=70,WB_Gallery.prototype.rowHeight=70,WB_Gallery.prototype.thumbAlign="left",WB_Gallery.prototype.thumbPadding=6,WB_Gallery.prototype.thumbOpacity=100,WB_Gallery.prototype.isFullWidth=!1,WB_Gallery.prototype.width=320,WB_Gallery.prototype.height=240,WB_Gallery.prototype.border=null,WB_Gallery.prototype.borderWidths=null,WB_Gallery.prototype.padding=null,WB_Gallery.prototype.galleryPath="",WB_Gallery.prototype.imageCover=!1,WB_Gallery.prototype.disablePopup=!1,WB_Gallery.prototype.showPictureCaption="always",WB_Gallery.prototype.displayedCaption=null,WB_Gallery.prototype.initialRender=!1,WB_Gallery.lightBoxInited=!1,WB_Gallery.prototype.__construct=function(t){switch(this.elem=$("#"+t.id),this.slideshowTimer=null,this.id=t.id,this.type=t.type,this.thumbWidth=t.thumbWidth,this.thumbHeight=t.thumbHeight,this.columnWidth=t.columnWidth,this.rowHeight=t.rowHeight,this.thumbAlign=t.thumbAlign,this.thumbPadding=t.thumbPadding,this.thumbOpacity=t.thumbOpacity,this.slideshowInterval=t.interval,this.slideshowSpeed=t.speed,this.images=t.images,this.imageIndex=0,this.border=t.border,this.borderWidths=t.borderWidths,this.padding=t.padding,this.isFullWidth=t.fullWidth,this.width=this.elem.width(),this.height=this.elem.height(),this.imageCover=t.imageCover,this.disablePopup=t.disablePopup,this.showPictureCaption=t.showPictureCaption,window.wb_builder||(this.initialRender=!0),this.type){case"slideshow":this.renderSlideshow();break;case"list":this.renderList();break;case"masonry":this.renderMasonry();break;default:this.renderThumbs()}},WB_Gallery.prototype.renderThumbs=function(){this.displayedImage=null,this.loadingImage=null;var t=null;this.elem.html(t=$('<div class="wb-thumbs-only" style="width: 100%; height: 100%; overflow: auto;"></div>')),this.elem.css("text-align",this.thumbAlign);for(var i=0;i<this.images.length;i++)this.addImage(t,this.images[i],i,!1);t.children(".wb_thumb").css("padding",this.thumbPadding/2+"px")},WB_Gallery.prototype.renderSlideshow=function(){var t=this;this.displayedImage=null,this.loadingImage=null;var i=$('<div class="gallery-slideshow"><div class="gallery-slide-image" style="overflow: hidden;"></div><div class="gallery-slide-left"><i class="fa fa-chevron-left"></i></div><div class="gallery-slide-right"><i class="fa fa-chevron-right"></i></div></div>');this.elem.html(i),this.listImgCont=i.children("div").eq(0),this.listImgCont.css("opacity",this.thumbOpacity/100);var e=i.children("div").eq(1),s=i.children("div").eq(2);e.click((function(){t.slideshowPrev()})),s.click((function(){t.slideshowNext()})),$(window).on("resize",(function(){var i=t.elem.width(),e=t.elem.height();i===t.width&&e===t.height||(t.width=i,t.height=e,t.displayImage(t.listImgCont))})),this.slideshowTimer&&clearInterval(this.slideshowTimer),this.slideshowInterval&&this.images.length>1?this.slideshowTimer=setTimeout((function(){t.slideshowNext()}),1e3*this.slideshowInterval):this.slideshowTimer=null,this.imageIndex=-1,this.slideshowNext()},WB_Gallery.prototype.renderList=function(){var t=this;this.elem.empty(),this.displayedImage=null,this.loadingImage=null;var i=this.width,e=this.height,s=this.thumbWidth,l=this.thumbHeight,h=$("<div></div>");this.callback=function(){var i=t.imageElems[t.imageIndex];$(i.parentNode.parentNode.parentNode).children(".tmb-selected").removeClass("tmb-selected"),$(i.parentNode.parentNode).addClass("tmb-selected")},this.imageElems={};for(var a=0;a<this.images.length;a++){var n=this.addImage(h,this.images[a],a,!0);n.idx=a,this.imageElems[n.idx]=n,$(n).css({cursor:"pointer"}),$(n).click((function(){t.imageIndex=this.idx,t.displayImage(t.listImgCont,t.callback)}));var r=$(n.parentNode.parentNode);a===this.imageIndex&&(r.addClass("tmb-selected"),s=this.thumbWidth+8,l=this.thumbHeight+8)}this.fullThumbWidth=s,this.fullThumbHeight=l,h.css({position:"absolute",left:"0",top:"5px",width:s*this.images.length+"px",height:l+"px"});var o=$("<div></div>");o.css({position:"relative",width:i+"px",height:e+"px"}),o.addClass("gallery-list");var d,p=$("<div></div>");p.css({position:"relative",width:i+"px",height:e-l-10+"px",overflow:"hidden"}),p.addClass("gallery-list-image");var m=document.createElement("DIV");$(m).css({position:"relative",float:"left",width:"16px",height:l+10+"px",cursor:"pointer"}),m.className="gallery-list-left",$(m).click((function(){t.slideBy(3*-t.fullThumbWidth)})),(d=document.createElement("I")).setAttribute("class","fa fa-chevron-left"),m.appendChild(d);var g=$("<div></div>");g.css({position:"relative",float:"left",width:i-32+"px",height:l+10+"px",overflow:"hidden"}),g.addClass("gallery-list-thumbs");var u=document.createElement("DIV");$(u).css({position:"relative",float:"left",width:"16px",height:l+10+"px",cursor:"pointer"}),u.className="gallery-list-right",$(u).click((function(){t.slideBy(3*t.fullThumbWidth)})),(d=document.createElement("I")).setAttribute("class","fa fa-chevron-right"),u.appendChild(d);var c=$("<div></div>");c.css({position:"relative",width:i+"px",height:l+10+"px",overflow:"hidden"}),g.append(h),c.append(m),c.append(g),c.append(u),o.append(p),o.append(c),$(window).on("resize",(function(){var i=t.elem.width(),e=t.elem.height();i===t.width&&e===t.height||(t.width=i,t.height=e,o.css({width:i,height:e}),p.css({width:i,height:e-l-10}),g.css({width:i-32}),c.css({width:i}),t.displayImage(t.listImgCont))})),this.listImgCont=p,this.thumbImgCont=g,this.elem.append(o),this.slideshowTimer&&clearInterval(this.slideshowTimer),this.slideshowInterval&&this.images.length>1?this.slideshowTimer=setTimeout((function(){t.slideshowNext(t.callback)}),1e3*this.slideshowInterval):this.slideshowTimer=null,this.imageIndex=-1,this.slideshowNext(this.callback)},WB_Gallery.prototype.renderMasonry=function(){this.displayedImage=null,this.loadingImage=null;var t=$('<div class="wb-masonry-items"/>'),i=$('<div class="wb-masonry" style="width: 100%; height: 100%; overflow: auto;"/>');i.append(t),this.elem.append(i),"left"===this.thumbAlign?t.css("float","left"):"right"===this.thumbAlign?t.css("float","right"):t.css("margin","0 auto");for(var e=0;e<this.images.length;e++)this.addImage(t,this.images[e],e,!1);t.children(".wb_thumb").css("padding",this.thumbPadding/2+"px"),t.masonry({itemSelector:".wb_thumb",columnWidth:this.columnWidth,fitWidth:!0});var s=this,l=this.elem.width();$(window).on("resize",(function(){var i=s.elem.width();i!==l&&(l=i,i<s.columnWidth+s.thumbPadding?t.find(".wb_thumb img").css({width:i-s.thumbPadding+"px",height:"auto"}):t.find(".wb_thumb img").css({width:"",height:""}))}))},WB_Gallery.prototype.slideBy=function(t){var i=$(this.thumbImgCont),e=$(this.thumbImgCont).children("div").eq(0),s=e.position(),l=s?s.left:0;l-=t;var h=-(e.width()-i.width());l<h&&(l=h),l>0&&(l=0),e.animate({left:l+"px"})},WB_Gallery.prototype.calcImageStyles=function(t,i,e){var s,l=this.isFullWidth||this.imageCover;s=0;var h=l?0:this.padding,a=t.innerWidth()-2*h-s,n=t.innerHeight()-2*h-0,r=e.width,o=e.height;if(l||r>a||o>n){var d=r/a,p=o/n,m=l?Math.min(d,p):Math.max(d,p);r=Math.floor(r/m),o=Math.floor(o/m)}return{left:Math.floor((a-r)/2+h),top:Math.floor((n-o)/2+h),image_width:r,image_height:o}},WB_Gallery.prototype.displayImage=function(t,i){var e=this,s=this.images[this.imageIndex];if(s){"function"==typeof i&&i();var l="thumbs"!==this.type&&"masonry"!==this.type&&s.hasOwnProperty("link")&&s.link?s.link:null,h=$(l?"<a>":"<div>");l&&(h.attr("href",l.url),l.target&&h.attr("target",l.target));var a=s.hasOwnProperty("title")&&s.title&&""!==s.title?s.title:"";""===a&&l&&l.name&&(a=l.name),h.attr("title",a),h.imageIndex=this.imageIndex;var n=h;h.addClass("gallery-image");var r=this.calcImageStyles(t,h,s),o=$('<div class="wb-picture-caption"/>');this.fillCaptionContainer(o,s,!1,!0)?("hover"===this.showPictureCaption&&o.addClass("wb-on-hover"),o.css({opacity:0,transition:"opacity "+(e.slideshowSpeed/1e3).toFixed(3)+"s linear"})):o=null,n.css({display:"none",position:"absolute",left:r.left+"px",top:r.top+"px"});var d=new Image;h.append(d),d.width=r.image_width,d.height=r.image_height,$(d).css({width:r.image_width,height:r.image_height}),$(d).css(this.isFullWidth||this.imageCover?{border:"none"}:this.border.css),d.alt="",d.onload=function(){e.displayedImage&&e.displayedImage.fadeOut(e.slideshowSpeed),e.displayedCaption&&(e.displayedCaption.css({opacity:0,transition:"opacity "+(e.slideshowSpeed/1e3).toFixed(3)+"s linear"}),setTimeout(function(){this.remove()}.bind(e.displayedCaption),e.slideshowSpeed)),e.displayedCaption=o,n.fadeIn(e.slideshowSpeed,(function(){e.displayedImage&&e.displayedImage.remove(),h.parent()&&h.parent().length?e.displayedImage=h:e.displayedImage=null,e.loadingImage=null,e.slideshowTimer&&(e.slideshowTimer&&clearTimeout(e.slideshowTimer),e.slideshowInterval&&e.images.length>1?e.slideshowTimer=setTimeout((function(){e.slideshowNext(e.callback)}),1e3*e.slideshowInterval):e.slideshowTimer=null)}))},t.append(h),o&&(t.append(o),setTimeout(function(){this.css("opacity","")}.bind(o),0),setTimeout(function(){this.css("transition","")}.bind(o),e.slideshowSpeed)),this.loadingImage=h,d.src=s.image,l||this.initImageLightBox(d,this.imageIndex)}},WB_Gallery.prototype.parseHash=function(){var t=window.location.hash.substring(1),i={gid:"",pid:""};if(t.length<5)return i;for(var e=t.split("&"),s=0;s<e.length;s++)if(e[s]){var l=e[s].split("=");l.length<2||(1==s&&l&&(i.gid=l[1]),2==s&&l&&(i.pid=l[1]))}return i},WB_Gallery.prototype.initImageLightBox=function(t,i){var e,s=WB_Gallery.lightBoxInited;if(WB_Gallery.lightBoxInited=!0,"slideshow"!==this.type&&"list"!==this.type||!this.disablePopup){this.initialRender&&(e=this.parseHash(),i=e.pid?parseInt(e.pid):i);var l=$("body > .pswp"),h=this;if(!s&&this.initialRender&&e&&e.pid){for(var a=[],n=0,r=h.images.length;n<r;n++){var o=h.images[n],d=o.hasOwnProperty("title")?o.title:null;a.push({src:o.image,w:o.width,h:o.height,msrc:null,title:null===d||""===d?"- wb-untitled -":d,link:o.hasOwnProperty("link")&&o.link?o.link:null,description:o.hasOwnProperty("description")?o.description:null})}new PhotoSwipe(l.get(0),PhotoSwipeUI_Default,a,{index:i,addCaptionHTMLFn:function(t,i,e){var s=$(i.children[0]);return s.empty(),h.fillCaptionContainer(s,t,!0,!0)}}).init(),h.initialRender=!1}$(t).css({cursor:"pointer"}).on("click touchstart touchend touchmove",(function(t){if("touchstart"===t.type?$(this).data("pswpDisabled",!1):"touchmove"===t.type&&$(this).data("pswpDisabled",!0),("click"===t.type||"touchend"===t.type)&&!$(this).data("pswpDisabled")){for(var e=[],s=0,a=h.images.length;s<a;s++){var n=h.images[s],r=n.hasOwnProperty("title")?n.title:null;e.push({src:n.image,w:n.width,h:n.height,msrc:null,title:null===r||""===r?"- wb-untitled -":r,link:n.hasOwnProperty("link")&&n.link?n.link:null,description:n.hasOwnProperty("description")?n.description:null})}new PhotoSwipe(l.get(0),PhotoSwipeUI_Default,e,{index:i,addCaptionHTMLFn:function(t,i,e){var s=$(i.children[0]);return s.empty(),h.fillCaptionContainer(s,t,!0,!0)}}).init(),l.attr("id",h.id+"_pswp")}}))}},WB_Gallery.prototype.slideshowNext=function(t){0!==this.images.length&&(this.imageIndex++,this.imageIndex>=this.images.length&&(this.imageIndex=0),this.displayImage(this.elem.children().first().children().first(),t))},WB_Gallery.prototype.slideshowPrev=function(t){0!==this.images.length&&(this.imageIndex--,this.imageIndex<0&&(this.imageIndex=this.images.length-1),this.displayImage(this.elem.children().first().children().first(),t))},WB_Gallery.prototype.addImage=function(t,i,e,s){var l="thumbs"===this.type||"masonry"===this.type,h=l&&i.hasOwnProperty("link")&&i.link?i.link:null,a=$(h?"<a/>":"<div/>");h&&(a.attr("href",h.url),h.target&&a.attr("target",h.target)),a.addClass("wb_thumb");var n=$("<div/>"),r=document.createElement("IMG");if(r.src=i.thumb,i.image===i.thumb){var o,d,p=i.width,m=i.height;if("masonry"===this.type)o=p/this.thumbWidth;else{var g=p/this.thumbWidth,u=m/this.thumbHeight;o=Math.min(g,u)}o||(o=1),p/=o,m/=o,d="masonry"===this.type?m:this.thumbHeight,r.width=p,r.height=m,$(r).css({position:"absolute",left:(this.thumbWidth-p)/2,top:(d-m)/2}),n.css({position:"relative","box-sizing":"content-box",width:this.thumbWidth,height:d,overflow:"hidden"})}else r.width=this.thumbWidth,"masonry"===this.type&&i.width?r.height=Math.round(this.thumbWidth*i.height/i.width):r.height=this.thumbHeight;var c=i.hasOwnProperty("title")&&i.title&&""!==i.title?i.title:"";if(""===c&&h&&h.name&&(c=h.name),a.attr("title",c),r.alt=c,$(r).css({zIndex:"1"}),s||h||this.initImageLightBox(r,e),("thumbs"===this.type||"masonry"===this.type)&&this.border&&this.border.css&&n.css(this.border.css),n.append(r),l&&this.thumbWidth>=100){var y=$('<div class="wb-picture-caption"/>');this.fillCaptionContainer(y,i,!1,!1)&&("hover"===this.showPictureCaption&&y.addClass("wb-on-hover"),n.append(y))}return a.append(n),t.append(a),r},WB_Gallery.prototype.fillCaptionContainer=function(t,i,e,s){var l="- wb-untitled -"===i.title?"":i.title,h=e?i.link:null,a=""!==l||h,n=s&&i.description&&""!==i.description;if(!a&&!n)return!1;if(a){var r=$('<h3 class="wb-lightbox-title">'),o=""!==l?l:h.name,d=h?$("<a>").attr("href",h.url).attr("target",h.target).text(o):document.createTextNode(o);r.append(d),t.append(r)}return n&&t.append($('<div class="wb-lightbox-description">').text(i.description)),!0};